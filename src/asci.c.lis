1     0000              MODULE asci_c
2     0000              LINE 0, "src/asci.c"
0     0000              
1     0000              ;--------------------------------------------------------
2     0000              ; File Created by SDCC : free open source ANSI-C Compiler
3     0000              ; Version 3.9.1 #11310 (MINGW64)
4     0000              ;--------------------------------------------------------
5     0000              ; Processed by Z88DK
6     0000              ;--------------------------------------------------------
7     0000              
8     0000              	EXTERN __divschar
9     0000              	EXTERN __divschar_callee
10    0000              	EXTERN __divsint
11    0000              	EXTERN __divsint_callee
12    0000              	EXTERN __divslong
13    0000              	EXTERN __divslong_callee
14    0000              	EXTERN __divslonglong
15    0000              	EXTERN __divslonglong_callee
16    0000              	EXTERN __divsuchar
17    0000              	EXTERN __divsuchar_callee
18    0000              	EXTERN __divuchar
19    0000              	EXTERN __divuchar_callee
20    0000              	EXTERN __divuint
21    0000              	EXTERN __divuint_callee
22    0000              	EXTERN __divulong
23    0000              	EXTERN __divulong_callee
24    0000              	EXTERN __divulonglong
25    0000              	EXTERN __divulonglong_callee
26    0000              	EXTERN __divuschar
27    0000              	EXTERN __divuschar_callee
28    0000              	EXTERN __modschar
29    0000              	EXTERN __modschar_callee
30    0000              	EXTERN __modsint
31    0000              	EXTERN __modsint_callee
32    0000              	EXTERN __modslong
33    0000              	EXTERN __modslong_callee
34    0000              	EXTERN __modslonglong
35    0000              	EXTERN __modslonglong_callee
36    0000              	EXTERN __modsuchar
37    0000              	EXTERN __modsuchar_callee
38    0000              	EXTERN __moduchar
39    0000              	EXTERN __moduchar_callee
40    0000              	EXTERN __moduint
41    0000              	EXTERN __moduint_callee
42    0000              	EXTERN __modulong
43    0000              	EXTERN __modulong_callee
44    0000              	EXTERN __modulonglong
45    0000              	EXTERN __modulonglong_callee
46    0000              	EXTERN __moduschar
47    0000              	EXTERN __moduschar_callee
48    0000              	EXTERN __mulint
49    0000              	EXTERN __mulint_callee
50    0000              	EXTERN __mullong
51    0000              	EXTERN __mullong_callee
52    0000              	EXTERN __mullonglong
53    0000              	EXTERN __mullonglong_callee
54    0000              	EXTERN __mulschar
55    0000              	EXTERN __mulschar_callee
56    0000              	EXTERN __mulsuchar
57    0000              	EXTERN __mulsuchar_callee
58    0000              	EXTERN __muluschar
59    0000              	EXTERN __muluschar_callee
60    0000              	EXTERN __rlslonglong
61    0000              	EXTERN __rlslonglong_callee
62    0000              	EXTERN __rlulonglong
63    0000              	EXTERN __rlulonglong_callee
64    0000              	EXTERN __rrslonglong
65    0000              	EXTERN __rrslonglong_callee
66    0000              	EXTERN __rrulonglong
67    0000              	EXTERN __rrulonglong_callee
68    0000              	EXTERN ___sdcc_call_hl
69    0000              	EXTERN ___sdcc_call_iy
70    0000              	EXTERN ___sdcc_enter_ix
71    0000              	EXTERN _banked_call
72    0000              	EXTERN _banked_ret
73    0000              	EXTERN ___fs2schar
74    0000              	EXTERN ___fs2schar_callee
75    0000              	EXTERN ___fs2sint
76    0000              	EXTERN ___fs2sint_callee
77    0000              	EXTERN ___fs2slong
78    0000              	EXTERN ___fs2slong_callee
79    0000              	EXTERN ___fs2slonglong
80    0000              	EXTERN ___fs2slonglong_callee
81    0000              	EXTERN ___fs2uchar
82    0000              	EXTERN ___fs2uchar_callee
83    0000              	EXTERN ___fs2uint
84    0000              	EXTERN ___fs2uint_callee
85    0000              	EXTERN ___fs2ulong
86    0000              	EXTERN ___fs2ulong_callee
87    0000              	EXTERN ___fs2ulonglong
88    0000              	EXTERN ___fs2ulonglong_callee
89    0000              	EXTERN ___fsadd
90    0000              	EXTERN ___fsadd_callee
91    0000              	EXTERN ___fsdiv
92    0000              	EXTERN ___fsdiv_callee
93    0000              	EXTERN ___fseq
94    0000              	EXTERN ___fseq_callee
95    0000              	EXTERN ___fsgt
96    0000              	EXTERN ___fsgt_callee
97    0000              	EXTERN ___fslt
98    0000              	EXTERN ___fslt_callee
99    0000              	EXTERN ___fsmul
100   0000              	EXTERN ___fsmul_callee
101   0000              	EXTERN ___fsneq
102   0000              	EXTERN ___fsneq_callee
103   0000              	EXTERN ___fssub
104   0000              	EXTERN ___fssub_callee
105   0000              	EXTERN ___schar2fs
106   0000              	EXTERN ___schar2fs_callee
107   0000              	EXTERN ___sint2fs
108   0000              	EXTERN ___sint2fs_callee
109   0000              	EXTERN ___slong2fs
110   0000              	EXTERN ___slong2fs_callee
111   0000              	EXTERN ___slonglong2fs
112   0000              	EXTERN ___slonglong2fs_callee
113   0000              	EXTERN ___uchar2fs
114   0000              	EXTERN ___uchar2fs_callee
115   0000              	EXTERN ___uint2fs
116   0000              	EXTERN ___uint2fs_callee
117   0000              	EXTERN ___ulong2fs
118   0000              	EXTERN ___ulong2fs_callee
119   0000              	EXTERN ___ulonglong2fs
120   0000              	EXTERN ___ulonglong2fs_callee
121   0000              	EXTERN ____sdcc_2_copy_src_mhl_dst_deix
122   0000              	EXTERN ____sdcc_2_copy_src_mhl_dst_bcix
123   0000              	EXTERN ____sdcc_4_copy_src_mhl_dst_deix
124   0000              	EXTERN ____sdcc_4_copy_src_mhl_dst_bcix
125   0000              	EXTERN ____sdcc_4_copy_src_mhl_dst_mbc
126   0000              	EXTERN ____sdcc_4_ldi_nosave_bc
127   0000              	EXTERN ____sdcc_4_ldi_save_bc
128   0000              	EXTERN ____sdcc_4_push_hlix
129   0000              	EXTERN ____sdcc_4_push_mhl
130   0000              	EXTERN ____sdcc_lib_setmem_hl
131   0000              	EXTERN ____sdcc_ll_add_de_bc_hl
132   0000              	EXTERN ____sdcc_ll_add_de_bc_hlix
133   0000              	EXTERN ____sdcc_ll_add_de_hlix_bc
134   0000              	EXTERN ____sdcc_ll_add_de_hlix_bcix
135   0000              	EXTERN ____sdcc_ll_add_deix_bc_hl
136   0000              	EXTERN ____sdcc_ll_add_deix_hlix
137   0000              	EXTERN ____sdcc_ll_add_hlix_bc_deix
138   0000              	EXTERN ____sdcc_ll_add_hlix_deix_bc
139   0000              	EXTERN ____sdcc_ll_add_hlix_deix_bcix
140   0000              	EXTERN ____sdcc_ll_asr_hlix_a
141   0000              	EXTERN ____sdcc_ll_asr_mbc_a
142   0000              	EXTERN ____sdcc_ll_copy_src_de_dst_hlix
143   0000              	EXTERN ____sdcc_ll_copy_src_de_dst_hlsp
144   0000              	EXTERN ____sdcc_ll_copy_src_deix_dst_hl
145   0000              	EXTERN ____sdcc_ll_copy_src_deix_dst_hlix
146   0000              	EXTERN ____sdcc_ll_copy_src_deixm_dst_hlsp
147   0000              	EXTERN ____sdcc_ll_copy_src_desp_dst_hlsp
148   0000              	EXTERN ____sdcc_ll_copy_src_hl_dst_de
149   0000              	EXTERN ____sdcc_ll_copy_src_hlsp_dst_de
150   0000              	EXTERN ____sdcc_ll_copy_src_hlsp_dst_deixm
151   0000              	EXTERN ____sdcc_ll_lsl_hlix_a
152   0000              	EXTERN ____sdcc_ll_lsl_mbc_a
153   0000              	EXTERN ____sdcc_ll_lsr_hlix_a
154   0000              	EXTERN ____sdcc_ll_lsr_mbc_a
155   0000              	EXTERN ____sdcc_ll_push_hlix
156   0000              	EXTERN ____sdcc_ll_push_mhl
157   0000              	EXTERN ____sdcc_ll_sub_de_bc_hl
158   0000              	EXTERN ____sdcc_ll_sub_de_bc_hlix
159   0000              	EXTERN ____sdcc_ll_sub_de_hlix_bc
160   0000              	EXTERN ____sdcc_ll_sub_de_hlix_bcix
161   0000              	EXTERN ____sdcc_ll_sub_deix_bc_hl
162   0000              	EXTERN ____sdcc_ll_sub_deix_hlix
163   0000              	EXTERN ____sdcc_ll_sub_hlix_bc_deix
164   0000              	EXTERN ____sdcc_ll_sub_hlix_deix_bc
165   0000              	EXTERN ____sdcc_ll_sub_hlix_deix_bcix
166   0000              	EXTERN ____sdcc_load_debc_deix
167   0000              	EXTERN ____sdcc_load_dehl_deix
168   0000              	EXTERN ____sdcc_load_debc_mhl
169   0000              	EXTERN ____sdcc_load_hlde_mhl
170   0000              	EXTERN ____sdcc_store_dehl_bcix
171   0000              	EXTERN ____sdcc_store_debc_hlix
172   0000              	EXTERN ____sdcc_store_debc_mhl
173   0000              	EXTERN ____sdcc_cpu_pop_ei
174   0000              	EXTERN ____sdcc_cpu_pop_ei_jp
175   0000              	EXTERN ____sdcc_cpu_push_di
176   0000              	EXTERN ____sdcc_outi
177   0000              	EXTERN ____sdcc_outi_128
178   0000              	EXTERN ____sdcc_outi_256
179   0000              	EXTERN ____sdcc_ldi
180   0000              	EXTERN ____sdcc_ldi_128
181   0000              	EXTERN ____sdcc_ldi_256
182   0000              	EXTERN ____sdcc_4_copy_srcd_hlix_dst_deix
183   0000              	EXTERN ____sdcc_4_and_src_mbc_mhl_dst_deix
184   0000              	EXTERN ____sdcc_4_or_src_mbc_mhl_dst_deix
185   0000              	EXTERN ____sdcc_4_xor_src_mbc_mhl_dst_deix
186   0000              	EXTERN ____sdcc_4_or_src_dehl_dst_bcix
187   0000              	EXTERN ____sdcc_4_xor_src_dehl_dst_bcix
188   0000              	EXTERN ____sdcc_4_and_src_dehl_dst_bcix
189   0000              	EXTERN ____sdcc_4_xor_src_mbc_mhl_dst_debc
190   0000              	EXTERN ____sdcc_4_or_src_mbc_mhl_dst_debc
191   0000              	EXTERN ____sdcc_4_and_src_mbc_mhl_dst_debc
192   0000              	EXTERN ____sdcc_4_cpl_src_mhl_dst_debc
193   0000              	EXTERN ____sdcc_4_xor_src_debc_mhl_dst_debc
194   0000              	EXTERN ____sdcc_4_or_src_debc_mhl_dst_debc
195   0000              	EXTERN ____sdcc_4_and_src_debc_mhl_dst_debc
196   0000              	EXTERN ____sdcc_4_and_src_debc_hlix_dst_debc
197   0000              	EXTERN ____sdcc_4_or_src_debc_hlix_dst_debc
198   0000              	EXTERN ____sdcc_4_xor_src_debc_hlix_dst_debc
199   0000              
200   0000              ;--------------------------------------------------------
201   0000              ; Public variables in this module
202   0000              ;--------------------------------------------------------
203   0000              	GLOBAL _asci_0_setup
204   0000              	GLOBAL _asci_0_putc
205   0000              	GLOBAL _asci_0_puts
206   0000              	GLOBAL _asci_0_put_ul
207   0000              ;--------------------------------------------------------
208   0000              ; Externals used
209   0000              ;--------------------------------------------------------
210   0000              	GLOBAL _z180_otdmr_callee
211   0000              	GLOBAL _z180_otdmr
212   0000              	GLOBAL _z180_otimr_callee
213   0000              	GLOBAL _z180_otimr
214   0000              	GLOBAL _z180_otdr_callee
215   0000              	GLOBAL _z180_otdr
216   0000              	GLOBAL _z180_otir_callee
217   0000              	GLOBAL _z180_otir
218   0000              	GLOBAL _z180_outp_callee
219   0000              	GLOBAL _z180_outp
220   0000              	GLOBAL _z180_indr_callee
221   0000              	GLOBAL _z180_indr
222   0000              	GLOBAL _z180_inir_callee
223   0000              	GLOBAL _z180_inir
224   0000              	GLOBAL _z180_inp_fastcall
225   0000              	GLOBAL _z180_inp
226   0000              	GLOBAL _z180_set_int_state_fastcall
227   0000              	GLOBAL _z180_set_int_state
228   0000              	GLOBAL _z180_get_int_state
229   0000              	GLOBAL _z180_delay_tstate_fastcall
230   0000              	GLOBAL _z180_delay_tstate
231   0000              	GLOBAL _z180_delay_ms_fastcall
232   0000              	GLOBAL _z180_delay_ms
233   0000              	GLOBAL _im2_remove_generic_callback_callee
234   0000              	GLOBAL _im2_remove_generic_callback
235   0000              	GLOBAL _im2_prepend_generic_callback_callee
236   0000              	GLOBAL _im2_prepend_generic_callback
237   0000              	GLOBAL _im2_append_generic_callback_callee
238   0000              	GLOBAL _im2_append_generic_callback
239   0000              	GLOBAL _im2_create_generic_isr_8080_callee
240   0000              	GLOBAL _im2_create_generic_isr_8080
241   0000              	GLOBAL _im2_create_generic_isr_callee
242   0000              	GLOBAL _im2_create_generic_isr
243   0000              	GLOBAL _im2_install_isr_callee
244   0000              	GLOBAL _im2_install_isr
245   0000              	GLOBAL _im2_init_fastcall
246   0000              	GLOBAL _im2_init
247   0000              ;--------------------------------------------------------
248   0000              ; special function registers
249   0000              ;--------------------------------------------------------
250   0000              defc _CNTLA0	=	0x00c0
251   0000              defc _CNTLA1	=	0x00c1
252   0000              defc _CNTLB0	=	0x00c2
253   0000              defc _CNTLB1	=	0x00c3
254   0000              defc _STAT0	=	0x00c4
255   0000              defc _STAT1	=	0x00c5
256   0000              defc _TDR0	=	0x00c6
257   0000              defc _TDR1	=	0x00c7
258   0000              defc _RDR0	=	0x00c8
259   0000              defc _RDR1	=	0x00c9
260   0000              defc _ASEXT0	=	0x00d2
261   0000              defc _ASEXT1	=	0x00d3
262   0000              defc _ASTC0L	=	0x00da
263   0000              defc _ASTC0H	=	0x00db
264   0000              defc _ASTC1L	=	0x00dc
265   0000              defc _ASTC1H	=	0x00dd
266   0000              defc _CNTR	=	0x00ca
267   0000              defc _TRDR	=	0x00cb
268   0000              defc _TMDR0L	=	0x00cc
269   0000              defc _TMDR0H	=	0x00cd
270   0000              defc _RLDR0L	=	0x00ce
271   0000              defc _RLDR0H	=	0x00cf
272   0000              defc _TCR	=	0x00d0
273   0000              defc _TMDR1L	=	0x00d4
274   0000              defc _TMDR1H	=	0x00d5
275   0000              defc _RLDR1L	=	0x00d6
276   0000              defc _RLDR1H	=	0x00d7
277   0000              defc _FRC	=	0x00d8
278   0000              defc _CMR	=	0x00de
279   0000              defc _CCR	=	0x00df
280   0000              defc _SAR0L	=	0x00e0
281   0000              defc _SAR0H	=	0x00e1
282   0000              defc _SAR0B	=	0x00e2
283   0000              defc _DAR0L	=	0x00e3
284   0000              defc _DAR0H	=	0x00e4
285   0000              defc _DAR0B	=	0x00e5
286   0000              defc _BCR0L	=	0x00e6
287   0000              defc _BCR0H	=	0x00e7
288   0000              defc _MAR1L	=	0x00e8
289   0000              defc _MAR1H	=	0x00e9
290   0000              defc _MAR1B	=	0x00ea
291   0000              defc _IAR1L	=	0x00eb
292   0000              defc _IAR1H	=	0x00ec
293   0000              defc _IAR1B	=	0x00ed
294   0000              defc _BCR1L	=	0x00ee
295   0000              defc _BCR1H	=	0x00ef
296   0000              defc _DSTAT	=	0x00f0
297   0000              defc _DMODE	=	0x00f1
298   0000              defc _DCNTL	=	0x00f2
299   0000              defc _IL	=	0x00f3
300   0000              defc _ITC	=	0x00f4
301   0000              defc _RCR	=	0x00f6
302   0000              defc _CBR	=	0x00f8
303   0000              defc _BBR	=	0x00f9
304   0000              defc _CBAR	=	0x00fa
305   0000              defc _OMCR	=	0x00fe
306   0000              defc _ICR	=	0x003f
307   0000              ;--------------------------------------------------------
308   0000              ; ram data
309   0000              ;--------------------------------------------------------
310   0000              	SECTION bss_compiler
311   0000              ;--------------------------------------------------------
312   0000              ; ram data
313   0000              ;--------------------------------------------------------
314   0000              
315   0000              IF 0
316   0000              
317   0000              ; .area _INITIALIZED removed by z88dk
318   0000              
319   0000              
320   0000              ENDIF
321   0000              
322   0000              ;--------------------------------------------------------
323   0000              ; absolute external ram data
324   0000              ;--------------------------------------------------------
325   0000              	SECTION IGNORE
326   0000              ;--------------------------------------------------------
327   0000              ; global & static initialisations
328   0000              ;--------------------------------------------------------
329   0000              	SECTION code_crt_init
330   0000              ;--------------------------------------------------------
331   0000              ; Home
332   0000              ;--------------------------------------------------------
333   0000              	SECTION IGNORE
334   0000              ;--------------------------------------------------------
335   0000              ; code
336   0000              ;--------------------------------------------------------
337   0000              	SECTION code_compiler
338   0000              ;	---------------------------------
339   0000              ; Function asci_0_setup
340   0000              ; ---------------------------------
341   0000              _asci_0_setup:
342   0000  3E 34       	ld	a,0x34
343   0002  ED 39 C0    	out0	(_CNTLA0), a
344   0005  3E 20       	ld	a,0x20
345   0007  ED 39 C2    	out0	(_CNTLB0), a
346   000A  C9          	ret
347   000B              	SECTION code_compiler
348   000B              ;	---------------------------------
349   000B              ; Function asci_0_putc
350   000B              ; ---------------------------------
351   000B              _asci_0_putc:
352   000B  DD E5       	push	ix
353   000D  DD 21 00 00 	ld	ix,0
354   0011  DD 39       	add	ix,sp
355   0013              l_asci_0_putc_00101:
356   0013  ED 38 C4    	in0	a, (_STAT0)
357   0016  CB 4F       	bit	1, a
358   0018  28 F9       	jr	Z,l_asci_0_putc_00101
359   001A  DD 7E 04    	ld	a,(ix+4)
360   001D  ED 39 C6    	out0	(_TDR0), a
361   0020  DD E1       	pop	ix
362   0022  C9          	ret
363   0023              	SECTION code_compiler
364   0023              ;	---------------------------------
365   0023              ; Function asci_0_puts
366   0023              ; ---------------------------------
367   0023              _asci_0_puts:
368   0023  DD E5       	push	ix
369   0025  DD 21 00 00 	ld	ix,0
370   0029  DD 39       	add	ix,sp
371   002B  DD 4E 04    	ld	c,(ix+4)
372   002E  DD 46 05    	ld	b,(ix+5)
373   0031              l_asci_0_puts_00101:
374   0031  0A          	ld	a, (bc)
375   0032  B7          	or	a, a
376   0033  28 0B       	jr	Z,l_asci_0_puts_00104
377   0035  03          	inc	bc
378   0036  C5          	push	bc
379   0037  F5          	push	af
380   0038  33          	inc	sp
381   0039  CD 0B 00    	call	_asci_0_putc
382   003C  33          	inc	sp
383   003D  C1          	pop	bc
384   003E  18 F1       	jr	l_asci_0_puts_00101
385   0040              l_asci_0_puts_00104:
386   0040  DD E1       	pop	ix
387   0042  C9          	ret
388   0043              	SECTION code_compiler
389   0043              ;	---------------------------------
390   0043              ; Function asci_0_put_ul
391   0043              ; ---------------------------------
392   0043              _asci_0_put_ul:
393   0043  DD E5       	push	ix
394   0045  DD 21 00 00 	ld	ix,0
395   0049  DD 39       	add	ix,sp
396   004B  3B          	dec	sp
397   004C  DD 36 FF 03 	ld	(ix-1),0x03
398   0050              l_asci_0_put_ul_00106:
399   0050  DD CB FF 7E 	bit	7,(ix-1)
400   0054  20 3C       	jr	NZ,l_asci_0_put_ul_00108
401   0056  DD 7E FF    	ld	a,(ix-1)
402   0059  87          	add	a, a
403   005A  87          	add	a, a
404   005B  DD 4E 04    	ld	c,(ix+4)
405   005E  DD 46 05    	ld	b,(ix+5)
406   0061  DD 5E 06    	ld	e,(ix+6)
407   0064  DD 56 07    	ld	d,(ix+7)
408   0067  3C          	inc	a
409   0068  18 08       	jr	l_asci_0_put_ul_00127
410   006A              l_asci_0_put_ul_00126:
411   006A  CB 3A       	srl	d
412   006C  CB 1B       	rr	e
413   006E  CB 18       	rr	b
414   0070  CB 19       	rr	c
415   0072              l_asci_0_put_ul_00127:
416   0072  3D          	dec	a
417   0073  20 F5       	jr	NZ, l_asci_0_put_ul_00126
418   0075  79          	ld	a, c
419   0076  E6 0F       	and	a,0x0f
420   0078  47          	ld	b, a
421   0079  48          	ld	c, b
422   007A  3E 09       	ld	a,0x09
423   007C  90          	sub	a, b
424   007D  38 05       	jr	C,l_asci_0_put_ul_00102
425   007F  79          	ld	a, c
426   0080  C6 30       	add	a,0x30
427   0082  18 03       	jr	l_asci_0_put_ul_00103
428   0084              l_asci_0_put_ul_00102:
429   0084  79          	ld	a, c
430   0085  C6 37       	add	a,0x37
431   0087              l_asci_0_put_ul_00103:
432   0087  F5          	push	af
433   0088  33          	inc	sp
434   0089  CD 0B 00    	call	_asci_0_putc
435   008C  33          	inc	sp
436   008D  DD 35 FF    	dec	(ix-1)
437   0090  18 BE       	jr	l_asci_0_put_ul_00106
438   0092              l_asci_0_put_ul_00108:
439   0092  33          	inc	sp
440   0093  DD E1       	pop	ix
441   0095  C9          	ret
442   0096              	SECTION IGNORE
443   0000              
